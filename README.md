**Развертывание кластера NiFi и Zookeeper**

Данный playbook Ansible предназначен для развертывания кластера NiFi и Zookeeper на наборе хостов. Playbook состоит из нескольких задач, которые выполняются в определенном порядке для обеспечения успешного развертывания кластера.

**Переменные**

Playbook определяет несколько переменных, которые используются в процессе развертывания:

* `nifi_version`: Версия NiFi, которая будет развернута (текущая версия - 1.20.0)
* `zookeeper_version`: Версия Zookeeper, которая будет развернута (текущая версия - 3.8.1)
* `nifi_nodes`: Список хостов, на которых будет запущен NiFi (текущий список - nifi1 и nifi2)
* `zookeeper_nodes`: Список хостов, на которых будет запущен Zookeeper (текущий список - zookeeper1, zookeeper2 и zookeeper3)
* `nifi_ssl_enabled`: Булевая переменная, указывающая, включен ли SSL для NiFi (текущее значение - true)
* `nifi_ldap_enabled`: Булевая переменная, указывающая, включен ли LDAP для NiFi (текущее значение - false)
* `nifi_log_path`: Путь, где будут храниться журналы NiFi (текущий путь - /var/log/nifi)
* `nifi_content_repository_path`: Путь, где будет храниться репозиторий контента NiFi (текущий путь - /var/nifi/content_repository)

**Задачи**

Playbook состоит из следующих задач:

1. **Определение типа ОС**: Эта задача определяет тип операционной системы, работающей на хосте (либо Debian, либо RedHat).
2. **Установка необходимых пакетов для Ubuntu**: Эта задача устанавливает необходимые пакеты (OpenJDK 11 и Docker) на хостах, основанных на Ubuntu.
3. **Установка необходимых пакетов для Oracle Linux**: Эта задача устанавливает необходимые пакеты (Java 11 OpenJDK и Docker) на хостах, основанных на Oracle Linux.
4. **Запуск сервиса Docker**: Эта задача запускает сервис Docker и включает его для автоматического запуска при загрузке.
5. **Развертывание Zookeeper**: Эта задача развертывает Zookeeper на указанных хостах (zookeeper1, zookeeper2 и zookeeper3) с помощью Docker.
6. **Развертывание Apache NiFi**: Эта задача развертывает Apache NiFi на указанных хостах (nifi1 и nifi2) с помощью Docker.

**Примечание**: Playbook использует конструкцию `when` Ansible для условного выполнения задач в зависимости от типа операционной системы хоста и его принадлежности к кластеру NiFi или Zookeeper.

**Запуск**

ansible-playbook -i inventory.ini site.yml